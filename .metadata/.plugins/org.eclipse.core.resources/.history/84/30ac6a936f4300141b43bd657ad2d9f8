package a03;

import java.util.List;

import javax.swing.SwingWorker;

public class MediaProgressChecker extends SwingWorker<Void,Void>{
	private MainPanel main;
	private boolean isCancelled = false;
	
	//constructor of swing worker takes in Main panel as input to invoke update on
	public MediaProgressChecker(MainPanel mp) {
		main = mp;
	}
	
	public void cancel() {
		isCancelled = true;
	}
	
	@Override
	protected Void doInBackground() throws Exception {
		//after a media is opened, continuously checks for media progress
		//when video is finish and not playable, restart
		while (true) {
			if (isCancelled) {
				break;
			}
			Thread.sleep(50);
			publish();
			//if (main.getMedia().isPlayable() == false) {
				System.out.println(main.getMedia().getTime());
				System.out.println("length is " + main.getMedia().getTime());
				//main.restart();
				//break;
			//}
		}
		return null;
	}

	@Override
	protected void process(List<Void> chunks) {
		//update progress bar UI, every publish()
		main.updateMediaProgress();
	}

}
